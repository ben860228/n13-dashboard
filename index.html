<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>經一綠能 - 專案管理平台</title>
    <style>
        /* --- 全局設定 --- */
        body, html { 
            margin: 0; padding: 0; 
            width: 100%; height: 100%; 
            overflow: hidden; 
            font-family: "Microsoft JhengHei", sans-serif; 
            background-color: #000; 
        }

        /* --- 1. Header 區域 --- */
        .portal-header {
            position: relative;
            width: 100%;
            height: 110px; /* 電腦版高度 */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            background-color: #5377A6; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.5); 
        }
        
        .logo-box {
            background: transparent !important; 
            padding: 0 !important; 
            border: none !important; 
            margin-bottom: 5px;
            box-shadow: none !important;
        }

        .portal-logo-img {
            height: 50px; 
            width: auto;
            display: block;
            filter: none; 
        }

        .portal-title {
            color: #fff;
            font-size: 1.1em; 
            font-weight: 900; 
            letter-spacing: 2px; 
            margin-top: 5px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        /* --- 2. 水面背景 --- */
        #water-canvas {
            position: absolute;
            top: 0; left: 0; /* 讓 Canvas 填滿全螢幕，Header 蓋在上面 */
            width: 100%; 
            height: 100%; 
            z-index: 1;
            background-color: #5377A6; 
        }

        /* --- 3. 台灣地圖容器 --- */
        .map-wrapper {
            position: absolute;
            top: 55%; left: 50%;
            width: 480px; /* 電腦版寬度 */
            height: auto; 
            
            /* 3D 姿態 */
            transform: translate(-50%, -50%) perspective(1000px) rotateX(45deg) rotateZ(20deg);
            
            transform-style: preserve-3d;
            transition: transform 0.5s ease-out;
            z-index: 10;
        }

        .map-wrapper:hover {
            transform: translate(-50%, -52%) perspective(1000px) rotateX(40deg) rotateZ(20deg);
        }

        .taiwan-img {
            width: 100%;
            height: auto;
            filter: drop-shadow(30px 40px 50px rgba(0,0,0,0.6));
            opacity: 0.95;
        }

        /* --- 4. 專案標籤 (Pin) --- */
        .project-pin {
            position: absolute;
            /* 抵消地圖旋轉，讓標籤站立 */
            transform: rotateZ(-20deg) rotateX(-45deg); 
            cursor: pointer;
            z-index: 20;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s;
        }

        .pin-label {
            background: #fff;
            color: #003366; 
            padding: 5px 12px;
            font-weight: 800; 
            font-size: 1em;
            border-radius: 3px;
            margin-bottom: 5px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            text-decoration: none;
            white-space: nowrap;
            border: 2px solid #fff;
        }

        .pin-line {
            width: 2px; height: 35px;
            background: rgba(255,255,255,0.9);
        }

        .pin-dot {
            width: 12px; height: 12px;
            background: #00E676; 
            border-radius: 50%;
            box-shadow: 0 0 10px #00E676;
            border: 2px solid #fff;
        }

        .project-pin:hover { z-index: 30; transform: rotateZ(-20deg) rotateX(-45deg) scale(1.1); }
        .project-pin:hover .pin-label {
            background: #FFC107; 
            color: #000;
            border-color: #FFC107;
        }

        /* --- 5. 座標設定 (N13) --- */
        .pin-n13 { 
            top: 42%; left: 47%; 
        }

        /* =========================================
           ★★★ RWD 手機版優化 (寬度 < 768px) ★★★ 
           ========================================= */
        @media (max-width: 768px) {
            /* 1. Header 瘦身 */
            .portal-header {
                height: 80px; /* 高度縮減 */
            }
            .portal-logo-img {
                height: 40px; /* LOGO 縮小 */
            }
            .portal-title {
                font-size: 0.9em; /* 文字縮小 */
                margin-top: 3px;
            }

            /* 2. 地圖縮放與位置調整 */
            .map-wrapper {
                width: 85vw; /* 改用螢幕寬度的 85% */
                top: 55%;    /* 維持置中 */
                
                /* 手機版角度稍微調整，避免歪太兇看不清楚 */
                transform: translate(-50%, -50%) perspective(800px) rotateX(40deg) rotateZ(15deg);
            }
            
            /* 手機版移除 hover 上浮效果，避免觸控怪怪的 */
            .map-wrapper:hover {
                transform: translate(-50%, -50%) perspective(800px) rotateX(40deg) rotateZ(15deg);
            }

            /* 3. 標籤調整 */
            .project-pin {
                /* 配合手機版地圖角度修正 */
                transform: rotateZ(-15deg) rotateX(-40deg);
            }
            .project-pin:hover {
                transform: rotateZ(-15deg) rotateX(-40deg) scale(1.1);
            }
            
            /* 標籤文字縮小，避免擋住地圖 */
            .pin-label {
                font-size: 0.9em;
                padding: 4px 10px;
            }
            .pin-line {
                height: 25px; /* 線條縮短 */
            }
        }

    </style>
</head>
<body>

    <div class="portal-header">
        <div class="logo-box">
            <img src="images/LOGO-WITHNAME-BLUE-HUNDE.png" alt="經一綠能" class="portal-logo-img">
        </div>
        <div class="portal-title">專案管理平台</div>
    </div>

    <canvas id="water-canvas"></canvas>

    <div class="map-wrapper">
        <img src="images/taiwan-map.png" alt="Taiwan Map" class="taiwan-img">

        <div class="project-pin pin-n13" onclick="location.href='n13-dashboard.html'">
            <a href="n13-dashboard.html" class="pin-label">南投 N13</a>
            <div class="pin-line"></div>
            <div class="pin-dot"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('water-canvas');
        const ctx = canvas.getContext('2d');
        
        let width, height;
        let t = 0;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        function draw() {
            // 底色：鎖定 #5377A6 漸層
            const bgGradient = ctx.createLinearGradient(0, 0, 0, height);
            bgGradient.addColorStop(0, '#5377A6');       
            bgGradient.addColorStop(1, '#2c3e50');       
            
            ctx.fillStyle = bgGradient;
            ctx.fillRect(0, 0, width, height);

            ctx.globalCompositeOperation = 'overlay'; 
            ctx.lineWidth = 3; 

            // 繪製光紋 (Caustics) - 白色半透明
            for (let i = 1; i <= 3; i++) {
                ctx.beginPath();
                ctx.strokeStyle = `rgba(255, 255, 255, ${0.12 / i})`;
                
                const step = 80; 

                for (let x = -100; x < width + 100; x += step) { 
                    let y = -50;
                    ctx.moveTo(x, y);

                    while(y < height + 50) {
                        y += 20; 
                        const xOffset = Math.sin(y * 0.005 + t * 0.002 * i + x * 0.01) * 25;
                        ctx.lineTo(x + xOffset, y);
                    }
                }
                ctx.stroke();
            }

            ctx.globalCompositeOperation = 'source-over';
            t++;
            requestAnimationFrame(draw);
        }

        draw();
    </script>

</body>
</html>
