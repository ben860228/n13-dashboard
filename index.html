<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¶“ä¸€ç¶ èƒ½-å·¥ç¨‹å°ˆæ¡ˆç®¡ç†å¹³å°</title>

    <link rel="icon" type="image/png" href="images/LOGO-NONAME-BLUE-ICON.png">

    <meta property="og:title" content="ç¶“ä¸€ç¶ èƒ½-å·¥ç¨‹å°ˆæ¡ˆç®¡ç†å¹³å°">
    <meta property="og:description" content="ç¶“ä¸€ç¶ èƒ½ å…¨å°å„è™•å·¥ç¨‹çš„é€²åº¦è¿½è¹¤å¹³å°. Ben Liu.">
    <meta property="og:image" content="images/LOGO-WITHNAME-BLUE-HUNDE.png">
    <meta property="og:type" content="website">

    <style>
        /* --- å…¨å±€è¨­å®š --- */
        body,
        html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: #000;
        }

        /* --- 1. Header å€åŸŸ --- */
        .portal-header {
            position: relative;
            width: 100%;
            height: 110px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            background-color: #5377A6;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
        }

        .logo-box {
            background: transparent !important;
            padding: 0 !important;
            border: none !important;
            margin-bottom: 5px;
            box-shadow: none !important;
        }

        .portal-logo-img {
            height: 50px;
            width: auto;
            display: block;
            filter: none;
        }

        .portal-title {
            color: #fff;
            font-size: 1.4em;
            font-weight: 900;
            letter-spacing: 2px;
            margin-top: 5px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* --- 2. æ°´é¢èƒŒæ™¯ --- */
        #water-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            background-color: #5377A6;
        }

        /* --- 3. å°ç£åœ°åœ–å®¹å™¨ --- */
        .map-wrapper {
            position: absolute;
            top: 55%;
            left: 50%;
            width: 480px;
            height: auto;
            transform: translate(-50%, -50%) perspective(1000px) rotateX(45deg) rotateZ(20deg);
            transform-style: preserve-3d;
            transition: transform 0.5s ease-out;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .map-wrapper:hover {
            transform: translate(-50%, -52%) perspective(1000px) rotateX(40deg) rotateZ(20deg);
        }

        .taiwan-img {
            width: 100%;
            height: auto;
            display: block;
            filter: drop-shadow(30px 40px 50px rgba(0, 0, 0, 0.6));
            opacity: 0;
            /* 1. é è¨­å…ˆéš±è—ï¼Œé¿é–‹æ–¹å½¢é™°å½± */
            transition: opacity 0.8s ease-out;
            /* 2. åŠ å…¥æ·¡å…¥å‹•ç•«æ•ˆæœ */
            user-select: none;
            user-select: none;
            -webkit-user-drag: none;
        }

        .taiwan-img.loaded {
            opacity: 0.95;
        }

        /* --- 4. å°ˆæ¡ˆæ¨™ç±¤çµ„ä»¶ --- */
        .project-pin-anchor {
            position: absolute;
            transform: rotateZ(-20deg) rotateX(-45deg) translateZ(100px);
            width: 0;
            height: 0;
            z-index: 20;
            cursor: pointer;
        }

        .pin-dot {
            position: absolute;
            top: -8px;
            left: -8px;
            width: 12px;
            height: 12px;
            background: #FF0000;
            border-radius: 50%;
            box-shadow: 0 0 15px #FF0000;
            border: 2px solid #fff;
            pointer-events: auto;
            z-index: 3;
            transition: transform 0.2s;
        }

        /* === å·¦å´å»¶ä¼¸æ¨£å¼ (N13) === */
        .pin-connector-L {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 150px;
            height: 60px;
            box-sizing: border-box;
            border-top: 2px solid #fff;
            border-right: 2px solid #fff;
            transform: translateX(1px);
            filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.5)) drop-shadow(0 0 5px rgba(255, 255, 255, 0.8));
            pointer-events: none;
            z-index: 1;
            transition: opacity 0.3s;
        }

        .pin-label {
            position: absolute;
            right: 150px;
            bottom: 60px;
            background: #fff;
            color: #003366;
            padding: 8px 18px;
            font-weight: 800;
            font-size: 1.3em;
            border-radius: 4px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.6);
            text-decoration: none;
            white-space: nowrap;
            border: 2px solid #fff;
            pointer-events: auto;
            transition: all 0.3s;
            z-index: 2;
            transform: translateY(50%) translateY(1px);
        }

        /* === å³å´å»¶ä¼¸æ¨£å¼ (ç‰é‡Œ) === */
        .pin-connector-L-right {
            position: absolute;
            top: 0;
            left: 0;
            width: 80px;
            height: 60px;
            box-sizing: border-box;
            border-left: 2px solid #fff;
            border-bottom: 2px solid #fff;
            transform: translateX(-1px);
            filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.5)) drop-shadow(0 0 5px rgba(255, 255, 255, 0.8));
            pointer-events: none;
            z-index: 1;
            transition: opacity 0.3s;
        }

        .pin-label-right {
            position: absolute;
            left: 78px;
            top: 60px;
            background: #fff;
            color: #003366;
            padding: 8px 18px;
            font-weight: 800;
            font-size: 1.3em;
            border-radius: 4px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.6);
            text-decoration: none;
            white-space: nowrap;
            border: 2px solid #fff;
            pointer-events: auto;
            transition: all 0.3s;
            z-index: 2;
            transform: translateY(-50%) translateX(2px);
        }

        /* Hover äº’å‹• (å…±ç”¨) */
        body:not(.is-calibrating) .project-pin-anchor:hover .pin-label,
        body:not(.is-calibrating) .project-pin-anchor:hover .pin-label-right {
            background: #FFC107;
            color: #000;
            border-color: #FFC107;
            transform: translateY(50%) translateY(1px) scale(1.1);
        }

        /* å³å´æ¨™ç±¤ Hover ä¿®æ­£ */
        body:not(.is-calibrating) .project-pin-anchor:hover .pin-label-right {
            transform: translateY(-50%) translateX(2px) scale(1.1);
        }

        body:not(.is-calibrating) .project-pin-anchor:hover .pin-dot {
            transform: scale(1.5);
        }

        body:not(.is-calibrating) .project-pin-anchor:hover .pin-connector-L,
        body:not(.is-calibrating) .project-pin-anchor:hover .pin-connector-L-right {
            border-color: #FFC107;
            filter: drop-shadow(0 0 8px #FFC107);
        }

        /* --- 5. åº§æ¨™è¨­å®š --- */

        /* å—æŠ• N13 */
        .pin-n13 {
            top: 43.4%;
            left: 50.6%;
        }

        .pin-n13:hover .pin-dot {
            box-shadow: 0 0 20px #FF0000;
        }

        /* èŠ±è“®ç‰é‡Œ */
        .pin-yuli {
            top: 54.4%;
            left: 73.2%;
        }

        .pin-yuli .pin-dot {
            background: #FFD700;
            box-shadow: 0 0 15px #FFD700;
        }

        .pin-yuli:hover .pin-dot {
            box-shadow: 0 0 20px #FFD700;
        }

        /* =========================================
           â˜…â˜…â˜… å·¥ç¨‹æ¨¡å¼ UI (éš±å½¢æ¿æ‰‹) â˜…â˜…â˜… 
           ========================================= */
        #calibration-toggle {
            position: fixed;
            bottom: 10px;
            left: 10px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            opacity: 0.05;
            font-size: 16px;
            cursor: pointer;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        #calibration-toggle:hover {
            opacity: 1;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
            transform: scale(1.2);
        }

        #debug-panel {
            display: none;
            position: fixed;
            top: 130px;
            left: 20px;
            background: rgba(0, 0, 0, 0.85);
            color: #00E676;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            z-index: 1000;
            border: 1px solid #00E676;
            pointer-events: none;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            min-width: 250px;
        }

        #copy-prompt-btn {
            margin-top: 10px;
            background: #2E7D32;
            color: #fff;
            border: none;
            padding: 8px 10px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 13px;
            font-weight: bold;
            pointer-events: auto;
            transition: background 0.2s;
        }

        #copy-prompt-btn:hover {
            background: #1B5E20;
        }

        #copy-prompt-btn:active {
            transform: translateY(1px);
        }

        body.is-calibrating .pin-label,
        body.is-calibrating .pin-label-right,
        body.is-calibrating .pin-connector-L,
        body.is-calibrating .pin-connector-L-right {
            display: none !important;
        }

        body.is-calibrating .pin-dot.selected {
            background: #00E676;
            box-shadow: 0 0 20px #00E676;
            transform: scale(1.5);
        }

        @media (max-width: 768px) {
            .portal-header {
                height: 80px;
            }

            .portal-logo-img {
                height: 40px;
            }

            .portal-title {
                font-size: 0.9em;
                margin-top: 3px;
            }

            /* --- ä¿®æ”¹é€™è£¡ --- */
            .map-wrapper {
                /* åŸæœ¬æ˜¯ 85vwï¼Œæ”¹ç‚º 60vw (ç¸®å°ä¸€é») */
                width: 60vw;

                /* åŸæœ¬æ˜¯ left: 50%ï¼Œæ”¹ç‚º 42% (ç¨å¾®å¾€å·¦ç§»ï¼ŒæŠŠå³é‚Šç©ºé–“è®“çµ¦ç‰é‡Œæ¨™ç±¤) */
                left: 42%;

                top: 55%;

                /* ä¿æŒåŸæœ¬çš„ 3D åƒæ•¸ä¸è®Š */
                transform: translate(-50%, -50%) perspective(800px) rotateX(40deg) rotateZ(15deg);
            }

            .map-wrapper:hover {
                transform: translate(-50%, -50%) perspective(800px) rotateX(40deg) rotateZ(15deg);
            }

            /* ---------------- */

            .pin-connector-L {
                width: 40px;
                height: 40px;
            }

            .pin-label {
                right: 40px;
                bottom: 40px;
                font-size: 1em;
                padding: 6px 12px;
            }

            .pin-connector-L-right {
                width: 50px;
                height: 40px;
            }

            .pin-label-right {
                left: 48px;
                top: 40px;
                font-size: 1em;
                padding: 6px 12px;
            }

            .project-pin-anchor {
                transform: rotateZ(-15deg) rotateX(-40deg) translateZ(50px);
            }
        }
    </style>
</head>

<body>

    <div class="portal-header">
        <div class="logo-box">
            <img src="images/LOGO-WITHNAME-BLUE-HUNDE.png" alt="ç¶“ä¸€ç¶ èƒ½" class="portal-logo-img">
        </div>
        <div class="portal-title">å·¥ç¨‹å°ˆæ¡ˆç®¡ç†å¹³å°</div>
    </div>

    <canvas id="water-canvas"></canvas>

    <div class="map-wrapper">
        <img src="images/taiwan-map.png" alt="Taiwan Map" class="taiwan-img">

        <div id="pin-n13" class="project-pin-anchor pin-n13" onclick="handlePinClick('JY_N13-dashboard.html', this)">
            <a href="JY_N13-dashboard.html" class="pin-label">å—æŠ• N13</a>
            <div class="pin-connector-L"></div>
            <div class="pin-dot"></div>
        </div>

        <div id="pin-yuli" class="project-pin-anchor pin-yuli" onclick="handleYuliClick(this)">
            <span class="pin-label-right" style="cursor: help;">èŠ±è“® ç‰é‡Œ</span>
            <div class="pin-connector-L-right"></div>
            <div class="pin-dot"></div>
        </div>

    </div>

    <button id="calibration-toggle" title="é–‹å•Ÿåº§æ¨™æ ¡æ­£æ¨¡å¼">ğŸ”§</button>

    <div id="debug-panel">
        <div>ğŸ”§ æ ¡æ­£æ¨¡å¼å·²å•Ÿå‹•</div>
        <div style="font-size:0.8em; color:#ccc; margin-bottom:5px;">é»æ“Šç´…é»é¸å–ï¼Œéµç›¤ç§»å‹•</div>
        <div style="margin-bottom:5px;">
            <span style="border:1px solid #666; padding:0 3px;">â†‘â†“â†â†’</span> ç§»å‹•
            <span style="border:1px solid #666; padding:0 3px;">Shift</span> åŠ é€Ÿ
        </div>
        <hr style="border-color:#333;">
        <div>Target: <span id="target-name" style="color:#fff;">N13</span></div>
        <div>Top: <span id="val-top">--</span>%</div>
        <div>Left: <span id="val-left">--</span>%</div>
        <button id="copy-prompt-btn">ğŸ“‹ è¤‡è£½ AI Prompt</button>
    </div>

    <script>
        const canvas = document.getElementById('water-canvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let t = 0;

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        function draw() {
            const bgGradient = ctx.createLinearGradient(0, 0, 0, height);
            bgGradient.addColorStop(0, '#5377A6');
            bgGradient.addColorStop(1, '#2c3e50');
            ctx.fillStyle = bgGradient;
            ctx.fillRect(0, 0, width, height);
            ctx.globalCompositeOperation = 'overlay';
            ctx.lineWidth = 3;
            for (let i = 1; i <= 3; i++) {
                ctx.beginPath();
                ctx.strokeStyle = `rgba(255, 255, 255, ${0.12 / i})`;
                const step = 80;
                for (let x = -100; x < width + 100; x += step) {
                    let y = -50;
                    ctx.moveTo(x, y);
                    while (y < height + 50) {
                        y += 20;
                        const xOffset = Math.sin(y * 0.005 + t * 0.005 * i + x * 0.01) * 25;
                        ctx.lineTo(x + xOffset, y);
                    }
                }
                ctx.stroke();
            }
            ctx.globalCompositeOperation = 'source-over';
            t++;
            requestAnimationFrame(draw);
        }
        draw();

        // --- æ–°å¢é€™æ®µï¼šè™•ç†åœ°åœ–æ·¡å…¥ ---
        const mapImg = document.querySelector('.taiwan-img');

        function showMap() {
            mapImg.classList.add('loaded');
        }

        // å¦‚æœåœ–ç‰‡å·²ç¶“åœ¨å¿«å–ä¸­(è®€å–å¾ˆå¿«)ï¼Œç›´æ¥é¡¯ç¤º
        if (mapImg.complete) {
            showMap();
        } else {
            // å¦‚æœé‚„åœ¨ä¸‹è¼‰ï¼Œç­‰ä¸‹è¼‰å®Œå†é¡¯ç¤º
            mapImg.onload = showMap;
        }
        // ---------------------------

        // --- æ ¡æ­£æ¨¡å¼é‚è¼¯ ---
        const toggleBtn = document.getElementById('calibration-toggle');
        const debugPanel = document.getElementById('debug-panel');
        const valTop = document.getElementById('val-top');
        const valLeft = document.getElementById('val-left');
        const targetName = document.getElementById('target-name');
        const copyBtn = document.getElementById('copy-prompt-btn');
        let isCalibrating = false;
        let selectedPin = null;

        function updateDebugInfo() {
            if (selectedPin) {
                const computed = getComputedStyle(selectedPin);
                const parentH = selectedPin.parentElement.offsetHeight;
                const parentW = selectedPin.parentElement.offsetWidth;
                let t = selectedPin.style.top ? parseFloat(selectedPin.style.top) : (parseFloat(computed.top) / parentH * 100);
                let l = selectedPin.style.left ? parseFloat(selectedPin.style.left) : (parseFloat(computed.left) / parentW * 100);
                valTop.textContent = t.toFixed(1);
                valLeft.textContent = l.toFixed(1);
                targetName.textContent = selectedPin.id.replace('pin-', '').toUpperCase();
            }
        }

        toggleBtn.addEventListener('click', () => {
            isCalibrating = !isCalibrating;
            if (isCalibrating) {
                document.body.classList.add('is-calibrating');
                debugPanel.style.display = 'block';
            } else {
                document.body.classList.remove('is-calibrating');
                debugPanel.style.display = 'none';
                document.querySelectorAll('.pin-dot').forEach(d => d.classList.remove('selected'));
            }
        });

        document.addEventListener('keydown', (e) => {
            if (!isCalibrating || !selectedPin) return;
            let t = parseFloat(valTop.textContent);
            let l = parseFloat(valLeft.textContent);
            const step = e.shiftKey ? 1.0 : 0.1;
            let changed = false;
            switch (e.key) {
                case 'ArrowUp': t -= step; changed = true; break;
                case 'ArrowDown': t += step; changed = true; break;
                case 'ArrowLeft': l -= step; changed = true; break;
                case 'ArrowRight': l += step; changed = true; break;
            }
            if (changed) {
                e.preventDefault();
                selectedPin.style.top = t.toFixed(1) + '%';
                selectedPin.style.left = l.toFixed(1) + '%';
                updateDebugInfo();
            }
        });

        copyBtn.addEventListener('click', () => {
            if (!selectedPin) return;
            const name = targetName.textContent;
            const t = valTop.textContent;
            const l = valLeft.textContent;
            const promptText = `ã€ä»»å‹™ï¼šæ›´æ–° index.html çš„åœ°åœ–åº§æ¨™ã€‘\n\næˆ‘æ­£åœ¨èª¿æ•´ 3D å…¥å£ç¶²ç«™ (index.html) çš„åœ°åœ–æ¨™é»ä½ç½®ã€‚\nç¶“éæ ¡æ­£æ¨¡å¼ç¢ºèªï¼Œå°ˆæ¡ˆã€${name}ã€‘åœ¨å°ç£åœ°åœ–ä¸Šçš„æ­£ç¢º CSS å®šä½å¦‚ä¸‹ï¼š\n\nç›®æ¨™æª”æ¡ˆï¼šindex.html\nç›®æ¨™ CSS é¡åˆ¥ï¼š.pin-${name.toLowerCase()}\næ–°åº§æ¨™æ•¸å€¼ï¼š\n  top: ${t}%;\n  left: ${l}%;\n\nåŸ·è¡Œè¦æ±‚ï¼š\nè«‹æ‰¾åˆ° <style> å€å¡Šä¸­çš„ .pin-${name.toLowerCase()}ï¼Œåƒ…æ›´æ–° top å’Œ left å±¬æ€§ã€‚è«‹åš´æ ¼ä¿ç•™è©²é¡åˆ¥åŸæœ¬çš„ positionã€transform (åŒ…å« translateZ) ç­‰å…¶ä»–è¨­å®šï¼Œä¸è¦è¦†è“‹æˆ–åˆªé™¤å®ƒå€‘ã€‚`;
            navigator.clipboard.writeText(promptText).then(() => {
                const originalText = copyBtn.textContent;
                copyBtn.textContent = "âœ… æŒ‡ä»¤å·²è¤‡è£½";
                setTimeout(() => copyBtn.textContent = originalText, 1500);
            });
        });

        window.handlePinClick = function (url, el) {
            if (isCalibrating) {
                document.querySelectorAll('.pin-dot').forEach(d => d.classList.remove('selected'));
                selectedPin = el;
                selectedPin.querySelector('.pin-dot').classList.add('selected');
                updateDebugInfo();
                event.preventDefault();
            } else {
                location.href = url;
            }
        }

        window.handleYuliClick = function (el) {
            if (isCalibrating) {
                document.querySelectorAll('.pin-dot').forEach(d => d.classList.remove('selected'));
                selectedPin = el;
                selectedPin.querySelector('.pin-dot').classList.add('selected');
                updateDebugInfo();
            } else {
                alert("ç‰é‡Œæ¡ˆçš„å„€è¡¨æ¿å¿«åšå®Œäº†ï¼ğŸ‘·â€â™‚ï¸è¡€æ±—å°åŠ‰åœ¨è¶•å·¥ä¸­å•¦ï¼");
            }
        }
    </script>

    <!-- Auto-Redirect Logic -->
    <script>
            (function () {
                const params = new URLSearchParams(window.location.search);
                const projectId = params.get('project');
                if (projectId === 'JY_N13') {
                    // Auto Redirect to N13 Dashboard
                    window.location.href = 'JY_N13-dashboard.html';
                } else if (projectId === 'JY_Yuli') {
                    // Show Coming Soon Alert
                    setTimeout(function () {
                        alert("ğŸš§ ç‰é‡Œå°ˆæ¡ˆå„€è¡¨æ¿å»ºç½®ä¸­... (Project: " + projectId + ")");
                    }, 500);
                }
            })();
    </script>
</body>

</html>